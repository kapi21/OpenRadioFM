# Hardware Compatibility & Engineering Notes (V5.0)

## device_target
*   **SoC**: MediaTek MT8163 (Quad-core ARM Cortex-A53)
*   **Android Version**: 11 / 12 (Go Edition)
*   **Radio Chip**: Integrated FM (MT6625 / MT6631 connectivity combo)
*   **Driver**: `fmradio_drv.ko`
*   **Service Package**: `com.hcn.autoradio`

## integration_analysis

### `IRadioServiceAPI`
The proprietary service provided by the head unit manufacturer exposes the following key methods:

*   `boolean IsStereo()`: Returns true if the pilot tone (19kHz) is locked.
*   `boolean IsDxLocal()`: Returns true if the tuner is in Local mode (less sensitive) or DX (more sensitive).
*   `int getCurrentFreq()`: Returns frequency in KHz.
*   `boolean IsScan()`, `boolean IsSeek()`: Returns tuner state.

**CRITICAL LIMITATION**: The `IRadioServiceAPI` **DOES NOT** expose methods for `getRSSI()` (Received Signal Strength Indicator) or `getSNR()` (Signal-to-Noise Ratio). These values are handled internally by the `fmradio_drv` and only determining logic (like "stop seek") is exposed.

### `HiddenRadioPlayer` (RDS)
We access RDS data by reading internal files generated by the radio service (Root/System access required):

*   **Path**: `/data/data/com.hcn.autoradio/files/` or observed via specific Broadcasts.
*   **Data Points**:
    *   `PS Name` (Program Service): 8-char station name.
    *   `RT` (Radio Text): 64-char scrolling text.
    *   `PTY` (Program Type): Integer code (0-31).
    *   `PI` (Program Identification): Hex code (e.g., E230).

## engineering_mode_implementation

Due to the lack of raw signal metrics, **Engineering Mode (V5.0)** uses an **Inferred Signal Quality Index (SQI)** algorithm:

```java
// SQI Estimation Algorithm
int sqi = 0;
if (hasRdsLock && isStereo) {
    sqi = 100; // Optimal signal
} else if (hasRdsLock) {
    sqi = 75;  // Good signal, but maybe mono due to multipath
} else if (isStereo) {
    sqi = 60;  // Strong signal, but no RDS (or RDS disabled)
} else {
    sqi = 30;  // Weak/Mono signal
}
```

## future_research_targets (V6.0+)
To bypass the API limitations, future versions may attempt to communicate directly with the kernel driver:

1.  **Direct `ioctl` calls**: Access `/dev/fm` directly if permissions allow.
2.  **Kernel Logs**: Parse `dmesg` for `[FMRADIO]` debug prints which often contain `rssi=-54` logs.
3.  **Property System**: Check `getprop` entries for `vendor.media.fm.rssi`.
